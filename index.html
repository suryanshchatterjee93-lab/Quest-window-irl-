<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quest Window</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">

<style>
:root { --glow:#00e5ff; }

body{
  margin:0;
  font-family:'Orbitron',sans-serif;
  background:black;
  color:#eaffff;
}

.window{
  max-width:420px;
  margin:40px auto;
  background:rgba(0,0,0,0.92);
  border:2px solid var(--glow);
  border-radius:18px;
  box-shadow:0 0 30px var(--glow);
  padding:20px;
  animation:flicker 0.15s linear;
}

@keyframes flicker{
  0%{opacity:0.7}
  100%{opacity:1}
}

h1{
  text-align:center;
  color:var(--glow);
  margin-bottom:10px;
}

.quest-box{
  border:1px solid var(--glow);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}

.label{ color:#7df9ff; font-size:0.8em; }
.value{ margin-bottom:6px; }

button{
  width:100%;
  margin-top:8px;
  padding:8px;
  border:none;
  border-radius:10px;
  font-family:inherit;
  font-weight:600;
  background:linear-gradient(135deg,var(--glow),#fff);
  color:black;
  cursor:pointer;
}

button.danger{
  background:linear-gradient(135deg,#ff1744,#000);
  color:white;
}

button:disabled{
  opacity:0.4;
}

.log{
  max-height:120px;
  overflow-y:auto;
  font-size:0.75em;
  background:rgba(0,0,0,0.5);
  padding:6px;
  border-radius:8px;
}
</style>
</head>

<body>

<div class="window">
  <h1>【 QUEST WINDOW 】</h1>

  <div class="quest-box" id="questBox">
    <div class="label">QUEST</div>
    <div class="value" id="qText">No active quest.</div>

    <div class="label">DIFFICULTY</div>
    <div class="value" id="qRank">—</div>

    <div class="label">REWARD</div>
    <div class="value" id="qReward">—</div>

    <div class="label">PENALTY</div>
    <div class="value" id="qPenalty">—</div>
  </div>

  <button onclick="acceptQuest()">ACCEPT QUEST</button>
  <button onclick="completeQuest()">COMPLETE QUEST</button>
  <button class="danger" onclick="rejectQuest()">REJECT QUEST</button>

  <div class="quest-box">
    <strong>LOG</strong>
    <div class="log" id="log"></div>
  </div>
</div>

<script>
/* ================= STATE ================= */
var currentQuest = null;
var questCooldown = false;

/* ================= QUEST POOL ================= */
var questPool = [
  { text:"50 push-ups", type:"Physical" },
  { text:"30 squats", type:"Physical" },
  { text:"20 minutes study", type:"Mental" },
  { text:"10 minutes meditation", type:"Discipline" },
  { text:"Cold shower", type:"Discipline" },
  { text:"Read 10 pages", type:"Mental" }
];

var ranks = ["E","D","C","B","A","S","SS","SSS"];

/* ================= CORE ================= */
function generateQuest(){
  var q = questPool[Math.floor(Math.random()*questPool.length)];
  var rank = ranks[Math.floor(Math.random()*ranks.length)];

  currentQuest = {
    text: q.text,
    rank: rank,
    reward: "+EXP / Discipline Boost",
    penalty: "Fatigue / Mental Drain"
  };

  renderQuest();
  save();
}

function renderQuest(){
  if(!currentQuest){
    document.getElementById('qText').innerText = "No active quest.";
    return;
  }

  document.getElementById('qText').innerText = currentQuest.text;
  document.getElementById('qRank').innerText = currentQuest.rank;
  document.getElementById('qReward').innerText = currentQuest.reward;
  document.getElementById('qPenalty').innerText = currentQuest.penalty;
}

function acceptQuest(){
  if(currentQuest) return;
  if(questCooldown) return log("Quest generation locked.");

  generateQuest();
  log("QUEST GENERATED.");
}

function completeQuest(){
  if(!currentQuest) return;

  log("QUEST COMPLETED → " + currentQuest.text);
  currentQuest = null;
  save();
  renderQuest();
}

function rejectQuest(){
  if(!currentQuest) return;

  log("QUEST REJECTED. COOLDOWN APPLIED.");
  currentQuest = null;
  questCooldown = true;

  setTimeout(function(){
    questCooldown = false;
    log("QUEST WINDOW READY.");
  }, 60000); // 1 min penalty

  save();
  renderQuest();
}

/* ================= LOG ================= */
function log(msg){
  var l = document.getElementById('log');
  l.innerHTML = "[" + new Date().toLocaleTimeString() + "] " + msg + "<br>" + l.innerHTML;
}

/* ================= SAVE ================= */
function save(){
  localStorage.setItem("questWindowSave", JSON.stringify({
    currentQuest,
    questCooldown
  }));
}

function load(){
  var raw = localStorage.getItem("questWindowSave");
  if(!raw) return;
  var d = JSON.parse(raw);
  currentQuest = d.currentQuest;
  questCooldown = d.questCooldown;
  renderQuest();
}

load();
</script>

</body>
</html>
